<mxfile host="Electron" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/26.0.9 Chrome/128.0.6613.186 Electron/32.2.5 Safari/537.36" version="26.0.9">
  <diagram name="Pagina-1" id="3eC-6GflDYz3U1tsH0RZ">
    <mxGraphModel dx="1194" dy="727" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="irP9ipBaVc85gEX89IVE-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="wefxeZgxiuNRXq0VxbFX-1" target="irP9ipBaVc85gEX89IVE-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wefxeZgxiuNRXq0VxbFX-1" value="Messager&lt;br&gt;invoke" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="140" y="250" width="110" height="60" as="geometry" />
        </mxCell>
        <mxCell id="irP9ipBaVc85gEX89IVE-1" value="&lt;div style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;&lt;pre style=&quot;font-family: &amp;quot;JetBrains Mono&amp;quot;, monospace; font-size: 9.8pt;&quot;&gt;&lt;font style=&quot;color: rgb(0, 0, 255);&quot;&gt;&lt;span style=&quot;color: rgb(0, 51, 179);&quot;&gt;public static &lt;/span&gt;Result &lt;span style=&quot;color: rgb(0, 98, 122);&quot;&gt;invokeOnBefore&lt;/span&gt;(&lt;span style=&quot;color: rgb(0, 51, 179);&quot;&gt;final &lt;/span&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;Object&lt;/span&gt;[] &lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;argumentArray&lt;/span&gt;, &lt;span style=&quot;font-style: italic; color: rgb(140, 140, 140);&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;font-style: italic; font-family: Menlo-Regular, monospace; color: rgb(140, 140, 140);&quot;&gt;业务方法入参列表&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-style: italic; font-family: Menlo-Regular, monospace; color: rgb(140, 140, 140);&quot;&gt;                                    &lt;/span&gt;&lt;span style=&quot;color: rgb(0, 51, 179);&quot;&gt;final int &lt;/span&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;listenerId&lt;/span&gt;,&lt;br&gt;                                    &lt;span style=&quot;color: rgb(0, 51, 179);&quot;&gt;final &lt;/span&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;String listenerClass&lt;/span&gt;, &lt;span style=&quot;font-style: italic; color: rgb(140, 140, 140);&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;font-style: italic; font-family: Menlo-Regular, monospace; color: rgb(140, 140, 140);&quot;&gt;只是为了排查时更加方便&lt;/span&gt;&lt;span style=&quot;font-style: italic; color: rgb(140, 140, 140);&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;font-style: italic; font-family: Menlo-Regular, monospace; color: rgb(140, 140, 140);&quot;&gt;所以在字节码增强时将注入的&lt;/span&gt;&lt;span style=&quot;font-style: italic; color: rgb(140, 140, 140);&quot;&gt; listener &lt;/span&gt;&lt;span style=&quot;font-style: italic; font-family: Menlo-Regular, monospace; color: rgb(140, 140, 140);&quot;&gt;类名也写到字节码中&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-style: italic; font-family: Menlo-Regular, monospace; color: rgb(140, 140, 140);&quot;&gt;                                    &lt;/span&gt;&lt;span style=&quot;color: rgb(0, 51, 179);&quot;&gt;final int &lt;/span&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;listenerTag&lt;/span&gt;, &lt;span style=&quot;font-style: italic; color: rgb(140, 140, 140);&quot;&gt;//listener&lt;/span&gt;&lt;span style=&quot;font-style: italic; font-family: Menlo-Regular, monospace; color: rgb(140, 140, 140);&quot;&gt;标志，比如仅处理业务流量或仅处理压测流量&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-style: italic; font-family: Menlo-Regular, monospace; color: rgb(140, 140, 140);&quot;&gt;                                    &lt;/span&gt;&lt;span style=&quot;color: rgb(0, 51, 179);&quot;&gt;final int &lt;/span&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;executionTag&lt;/span&gt;, &lt;span style=&quot;font-style: italic; color: rgb(140, 140, 140);&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;font-style: italic; font-family: Menlo-Regular, monospace; color: rgb(140, 140, 140);&quot;&gt;执行标记，&lt;/span&gt;&lt;span style=&quot;font-style: italic; color: rgb(140, 140, 140);&quot;&gt; 1 &lt;/span&gt;&lt;span style=&quot;font-style: italic; font-family: Menlo-Regular, monospace; color: rgb(140, 140, 140);&quot;&gt;忽略本次执行&lt;/span&gt;&lt;span style=&quot;font-style: italic; color: rgb(140, 140, 140);&quot;&gt;  -1 &lt;/span&gt;&lt;span style=&quot;font-style: italic; font-family: Menlo-Regular, monospace; color: rgb(140, 140, 140);&quot;&gt;执行&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-style: italic; font-family: Menlo-Regular, monospace; color: rgb(140, 140, 140);&quot;&gt;                                    &lt;/span&gt;&lt;span style=&quot;color: rgb(0, 51, 179);&quot;&gt;final &lt;/span&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;Class clazz&lt;/span&gt;, &lt;span style=&quot;font-style: italic; color: rgb(140, 140, 140);&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;font-style: italic; font-family: Menlo-Regular, monospace; color: rgb(140, 140, 140);&quot;&gt;业务&lt;/span&gt;&lt;span style=&quot;font-style: italic; color: rgb(140, 140, 140);&quot;&gt;class DruidDataSource.class&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-style: italic; color: rgb(140, 140, 140);&quot;&gt;                                    &lt;/span&gt;&lt;span style=&quot;color: rgb(0, 51, 179);&quot;&gt;final &lt;/span&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;String javaMethodName&lt;/span&gt;, &lt;span style=&quot;font-style: italic; color: rgb(140, 140, 140);&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;font-style: italic; font-family: Menlo-Regular, monospace; color: rgb(140, 140, 140);&quot;&gt;业务方法名&lt;/span&gt;&lt;span style=&quot;font-style: italic; color: rgb(140, 140, 140);&quot;&gt; getConnection&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-style: italic; color: rgb(140, 140, 140);&quot;&gt;                                    &lt;/span&gt;&lt;span style=&quot;color: rgb(0, 51, 179);&quot;&gt;final &lt;/span&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;String javaMethodDesc&lt;/span&gt;, &lt;span style=&quot;font-style: italic; color: rgb(140, 140, 140);&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;font-style: italic; font-family: Menlo-Regular, monospace; color: rgb(140, 140, 140);&quot;&gt;业务&lt;/span&gt;&lt;span style=&quot;font-style: italic; color: rgb(140, 140, 140);&quot;&gt;Class&lt;/span&gt;&lt;span style=&quot;font-style: italic; font-family: Menlo-Regular, monospace; color: rgb(140, 140, 140);&quot;&gt;描述&lt;/span&gt;&lt;span style=&quot;font-style: italic; color: rgb(140, 140, 140);&quot;&gt; (J)Lcom/alibaba/druid/pool/DruidPooledConnection&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-style: italic; color: rgb(140, 140, 140);&quot;&gt;                                    &lt;/span&gt;&lt;span style=&quot;color: rgb(0, 51, 179);&quot;&gt;final &lt;/span&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;Object target&lt;/span&gt;) &lt;span style=&quot;font-style: italic; color: rgb(140, 140, 140);&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;font-style: italic; font-family: Menlo-Regular, monospace; color: rgb(140, 140, 140);&quot;&gt;业务对象&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="130" y="60" width="360" height="160" as="geometry" />
        </mxCell>
        <mxCell id="irP9ipBaVc85gEX89IVE-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="irP9ipBaVc85gEX89IVE-2" target="irP9ipBaVc85gEX89IVE-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="irP9ipBaVc85gEX89IVE-2" value="EventListenerHandler" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="350" y="250" width="140" height="60" as="geometry" />
        </mxCell>
        <mxCell id="irP9ipBaVc85gEX89IVE-3" value="LazyEventListenerProxy" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="350" y="390" width="140" height="60" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
